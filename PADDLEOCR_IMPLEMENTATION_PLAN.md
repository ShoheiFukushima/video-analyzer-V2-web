# PaddleOCR ã‚»ãƒ«ãƒ•ãƒ›ã‚¹ãƒˆå®Ÿè£…è¨ˆç”»

**ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: ğŸ“‹ **è¨ˆç”»æ®µéšï¼ˆå®Ÿè£…æœªç€æ‰‹ï¼‰**
**ä½œæˆæ—¥**: 2025å¹´11æœˆ16æ—¥
**æœ€çµ‚æ›´æ–°**: 2025å¹´11æœˆ16æ—¥
**æ‰¿èªçŠ¶æ³**: â³ **ãƒ¦ãƒ¼ã‚¶ãƒ¼æ‰¿èªå¾…ã¡**

---

## âš ï¸ é‡è¦: å®Ÿè£…é–‹å§‹æ¡ä»¶

**ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯å®Ÿè£…è¨ˆç”»ã®ã¿ã‚’è¨˜è¼‰ã—ã¦ã„ã¾ã™ã€‚å®Ÿè£…ã¯ä»¥ä¸‹ã®æ¡ä»¶ã‚’æº€ãŸã—ãŸå ´åˆã®ã¿é–‹å§‹ã—ã¾ã™ï¼š**

1. âœ… **ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®æ˜ç¤ºçš„ãªå®Ÿè£…GOæŒ‡ç¤º**
2. âœ… **A/Bãƒ†ã‚¹ãƒˆæˆ¦ç•¥ã®æ‰¿èª**
3. âœ… **ãƒªã‚½ãƒ¼ã‚¹ç¢ºä¿ã®ç¢ºèª**ï¼ˆé–‹ç™ºæ™‚é–“ã€äºˆç®—ï¼‰

**å®Ÿè£…é–‹å§‹ã¾ã§ã®çŠ¶æ…‹**: ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€Œææ¡ˆã€ã§ã‚ã‚Šã€ã€Œå®Ÿè¡Œæ¸ˆã¿ã€ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

---

## ğŸ¯ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

**ç›®çš„**: Gemini Vision APIã®ä»£æ›¿ã¨ã—ã¦ã€PaddleOCRã‚’Cloud Runã«ã‚»ãƒ«ãƒ•ãƒ›ã‚¹ãƒˆã—ã€å®Œå…¨ç„¡æ–™ï¼ˆå®Ÿè¡Œæ™‚é–“èª²é‡‘ã®ã¿ï¼‰ã§OCRæ©Ÿèƒ½ã‚’æä¾›ã™ã‚‹
**æœŸå¾…åŠ¹æœ**: å¹´é–“ã‚³ã‚¹ãƒˆå‰Šæ¸› ç´„Â¥228,000ã€ç²¾åº¦å‘ä¸Šï¼ˆæ—¥æœ¬èªç‰¹åŒ–ï¼‰
**å®Ÿè£…ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ**: A/Bãƒ†ã‚¹ãƒˆã«ã‚ˆã‚‹æ®µéšçš„æ¤œè¨¼ãƒ»ç§»è¡Œ

---

## ğŸ“Š ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼

### ç¾çŠ¶ã®å•é¡Œ
- **Gemini Vision APIã‚³ã‚¹ãƒˆ**: æœˆ10ä¸‡ç”»åƒå‡¦ç†ã§ç´„Â¥21,000ï¼ˆå¹´é–“Â¥252,000ï¼‰
- **OCRç²¾åº¦å•é¡Œ**: JSONãƒ‘ãƒ¼ã‚¹å¤±æ•—ã€æ—¥æœ¬èªãƒ†ã‚­ã‚¹ãƒˆæ¤œå‡ºã®ä¸å®‰å®šæ€§
- **å¤–éƒ¨APIã¸ã®ä¾å­˜**: ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã€ã‚µãƒ¼ãƒ“ã‚¹åœæ­¢ãƒªã‚¹ã‚¯

### è§£æ±ºç­–
- **PaddleOCRã‚»ãƒ«ãƒ•ãƒ›ã‚¹ãƒˆ**: Cloud Runã«å°‚ç”¨ã‚³ãƒ³ãƒ†ãƒŠãƒ‡ãƒ—ãƒ­ã‚¤
- **å®Œå…¨ç„¡æ–™**: APIã‚³ã‚¹ãƒˆã‚¼ãƒ­ï¼ˆCloud Runå®Ÿè¡Œæ™‚é–“èª²é‡‘ç´„Â¥2,000/æœˆã®ã¿ï¼‰
- **é«˜ç²¾åº¦**: Baidué–‹ç™ºã€æ—¥æœ¬èªãƒ»ä¸­å›½èªã«ç‰¹åŒ–ã€å°ã•ã„æ–‡å­—ã‚‚é«˜ç²¾åº¦

### ROIï¼ˆæŠ•è³‡å¯¾åŠ¹æœï¼‰
- **åˆæœŸå®Ÿè£…æ™‚é–“**: 1-2æ—¥ï¼ˆDockerã‚³ãƒ³ãƒ†ãƒŠåŒ–ã€APIå®Ÿè£…ã€ãƒ†ã‚¹ãƒˆï¼‰
- **æœˆé–“ã‚³ã‚¹ãƒˆå‰Šæ¸›**: Â¥19,000ï¼ˆÂ¥21,000 â†’ Â¥2,000ï¼‰
- **å¹´é–“ã‚³ã‚¹ãƒˆå‰Šæ¸›**: Â¥228,000
- **æŠ•è³‡å›åæœŸé–“**: å³æ™‚ï¼ˆå®Ÿè£…å®Œäº†ã¨åŒæ™‚ã«ã‚³ã‚¹ãƒˆå‰Šæ¸›é–‹å§‹ï¼‰

---

## ğŸ—ï¸ ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ç¾åœ¨ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼ˆGemini Visionï¼‰

```
[Video Analyzer Worker (Cloud Run)]
          â†“
   [Gemini Vision API (å¤–éƒ¨)]
     - REST APIå‘¼ã³å‡ºã—
     - Base64ç”»åƒé€ä¿¡
     - JSON/è‡ªç„¶è¨€èªãƒ¬ã‚¹ãƒãƒ³ã‚¹å—ä¿¡
     - ã‚³ã‚¹ãƒˆ: Â¥212/1000ç”»åƒ
```

### æ–°ã—ã„ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼ˆPaddleOCRï¼‰

```
[Video Analyzer Worker (Cloud Run)]
          â†“ å†…éƒ¨HTTPå‘¼ã³å‡ºã—
[PaddleOCR Service (Cloud Run)]
   - å°‚ç”¨Dockerã‚³ãƒ³ãƒ†ãƒŠ
   - PaddleOCR Pythonå®Ÿè£…
   - FastAPI REST API
   - ã‚³ã‚¹ãƒˆ: å®Ÿè¡Œæ™‚é–“èª²é‡‘ã®ã¿
```

### ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹è¨­è¨ˆ

**ã‚µãƒ¼ãƒ“ã‚¹åˆ†é›¢ã®ç†ç”±**:
1. **ç‹¬ç«‹ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°**: OCRå‡¦ç†ã®è² è·ã«å¿œã˜ã¦å€‹åˆ¥ã«ã‚¹ã‚±ãƒ¼ãƒ«
2. **è¨€èªåˆ†é›¢**: Node.js (Video Analyzer) ã¨ Python (PaddleOCR) ã‚’åˆ†é›¢
3. **å†åˆ©ç”¨æ€§**: ä»–ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã‚‚PaddleOCR Serviceã‚’å†åˆ©ç”¨å¯èƒ½
4. **éšœå®³åˆ†é›¢**: OCRã‚µãƒ¼ãƒ“ã‚¹ã®éšœå®³ãŒæœ¬ä½“ã«å½±éŸ¿ã—ãªã„

---

## ğŸ› ï¸ å®Ÿè£…ã‚¹ãƒ†ãƒƒãƒ—

### Phase 1: PaddleOCR Serviceã®æ§‹ç¯‰ï¼ˆDay 1ï¼‰

#### 1-1: Dockerã‚³ãƒ³ãƒ†ãƒŠä½œæˆ

**ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ **:
```
video-analyzer-V2-web/
â”œâ”€â”€ paddleocr-service/
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â”œâ”€â”€ main.py
â”‚   â”œâ”€â”€ ocr_service.py
â”‚   â”œâ”€â”€ .dockerignore
â”‚   â”œâ”€â”€ .gcloudignore
â”‚   â””â”€â”€ README.md
```

**Dockerfile**:
```dockerfile
FROM python:3.11-slim

# Install system dependencies for PaddleOCR
RUN apt-get update && apt-get install -y \
    libgomp1 \
    libglib2.0-0 \
    libsm6 \
    libxrender1 \
    libxext6 \
    && rm -rf /var/lib/apt/lists/*

# Set working directory
WORKDIR /app

# Copy requirements
COPY requirements.txt .

# Install Python dependencies
RUN pip install --no-cache-dir -r requirements.txt

# Copy application code
COPY . .

# Expose port
EXPOSE 8080

# Run FastAPI server
CMD ["uvicorn", "main:app", "--host", "0.0.0.0", "--port", "8080"]
```

**requirements.txt**:
```
fastapi==0.109.0
uvicorn[standard]==0.27.0
paddleocr==2.7.0.3
paddlepaddle==2.6.0
Pillow==10.2.0
pydantic==2.5.3
python-multipart==0.0.6
```

**main.py** (FastAPI ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³):
```python
from fastapi import FastAPI, File, UploadFile, HTTPException
from fastapi.responses import JSONResponse
from pydantic import BaseModel
from typing import Optional
import base64
import io
from PIL import Image
from ocr_service import PaddleOCRService

app = FastAPI(
    title="PaddleOCR Service",
    description="High-accuracy OCR service using PaddleOCR (Japanese/Chinese/English)",
    version="1.0.0"
)

# Initialize PaddleOCR service
ocr_service = PaddleOCRService(
    lang='japan',  # Japanese language model
    use_angle_cls=True,  # Enable text rotation detection
    use_gpu=False  # CPU mode (Cloud Run doesn't have GPU)
)

class OCRRequest(BaseModel):
    image_base64: str  # Base64 encoded image
    confidence_threshold: Optional[float] = 0.5  # Minimum confidence to include text

class OCRResponse(BaseModel):
    text: str  # Extracted text (concatenated with \n)
    confidence: float  # Average confidence score (0-1)
    details: list  # Detailed results per detected text box

@app.get("/")
async def root():
    return {"status": "ok", "service": "PaddleOCR", "version": "1.0.0"}

@app.get("/health")
async def health():
    return {"status": "ok", "timestamp": datetime.utcnow().isoformat()}

@app.post("/ocr", response_model=OCRResponse)
async def perform_ocr(request: OCRRequest):
    """
    Perform OCR on base64 encoded image

    Request:
    {
      "image_base64": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAA...",
      "confidence_threshold": 0.5
    }

    Response:
    {
      "text": "ä»Šæ—¥ã®å¤©æ°—ã¯æ™´ã‚Œ\\nToday's weather is sunny",
      "confidence": 0.92,
      "details": [
        {"text": "ä»Šæ—¥ã®å¤©æ°—ã¯æ™´ã‚Œ", "confidence": 0.95, "bbox": [[10, 20], [100, 20], [100, 40], [10, 40]]},
        {"text": "Today's weather is sunny", "confidence": 0.89, "bbox": [[10, 50], [150, 50], [150, 70], [10, 70]]}
      ]
    }
    """
    try:
        # Decode base64 image
        image_data = base64.b64decode(request.image_base64.split(',')[-1])
        image = Image.open(io.BytesIO(image_data))

        # Perform OCR
        result = ocr_service.perform_ocr(
            image,
            confidence_threshold=request.confidence_threshold
        )

        return JSONResponse(content=result)

    except Exception as e:
        raise HTTPException(status_code=500, detail=f"OCR failed: {str(e)}")

@app.post("/ocr/upload", response_model=OCRResponse)
async def perform_ocr_upload(
    file: UploadFile = File(...),
    confidence_threshold: float = 0.5
):
    """
    Perform OCR on uploaded image file

    Multipart form data:
    - file: image file (PNG, JPG, JPEG)
    - confidence_threshold: 0.5 (optional)
    """
    try:
        # Read uploaded file
        image_data = await file.read()
        image = Image.open(io.BytesIO(image_data))

        # Perform OCR
        result = ocr_service.perform_ocr(
            image,
            confidence_threshold=confidence_threshold
        )

        return JSONResponse(content=result)

    except Exception as e:
        raise HTTPException(status_code=500, detail=f"OCR failed: {str(e)}")
```

**ocr_service.py** (PaddleOCR ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯):
```python
from paddleocr import PaddleOCR
from PIL import Image
import numpy as np
from typing import Dict, List, Any

class PaddleOCRService:
    def __init__(self, lang='japan', use_angle_cls=True, use_gpu=False):
        """
        Initialize PaddleOCR service

        Args:
            lang: Language model ('japan', 'en', 'chinese_cht', etc.)
            use_angle_cls: Enable text rotation detection
            use_gpu: Use GPU acceleration (False for Cloud Run)
        """
        self.ocr = PaddleOCR(
            lang=lang,
            use_angle_cls=use_angle_cls,
            use_gpu=use_gpu,
            show_log=False  # Suppress PaddleOCR logs
        )

    def perform_ocr(
        self,
        image: Image.Image,
        confidence_threshold: float = 0.5
    ) -> Dict[str, Any]:
        """
        Perform OCR on PIL Image

        Args:
            image: PIL Image object
            confidence_threshold: Minimum confidence to include text (0-1)

        Returns:
            {
              "text": "extracted text",
              "confidence": 0.92,
              "details": [{"text": "...", "confidence": 0.95, "bbox": [...]}, ...]
            }
        """
        # Convert PIL Image to numpy array
        img_array = np.array(image)

        # Perform OCR
        results = self.ocr.ocr(img_array, cls=True)

        # Parse results
        extracted_texts = []
        confidences = []
        details = []

        if results and results[0]:
            for line in results[0]:
                bbox, (text, confidence) = line

                # Filter by confidence threshold
                if confidence >= confidence_threshold:
                    extracted_texts.append(text)
                    confidences.append(confidence)
                    details.append({
                        "text": text,
                        "confidence": round(confidence, 3),
                        "bbox": bbox
                    })

        # Calculate average confidence
        avg_confidence = sum(confidences) / len(confidences) if confidences else 0

        # Concatenate text with newlines
        concatenated_text = '\n'.join(extracted_texts)

        return {
            "text": concatenated_text,
            "confidence": round(avg_confidence, 3),
            "details": details
        }
```

#### 1-2: ãƒ­ãƒ¼ã‚«ãƒ«ãƒ†ã‚¹ãƒˆ

```bash
# ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ
mkdir paddleocr-service
cd paddleocr-service

# ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆï¼ˆä¸Šè¨˜ã‚³ãƒ¼ãƒ‰ï¼‰
# ...

# Dockerãƒ“ãƒ«ãƒ‰
docker build -t paddleocr-service .

# ãƒ­ãƒ¼ã‚«ãƒ«å®Ÿè¡Œ
docker run -p 8080:8080 paddleocr-service

# ãƒ†ã‚¹ãƒˆ
curl http://localhost:8080/health
# â†’ {"status":"ok","timestamp":"2025-11-16T12:00:00.000000"}

# OCRãƒ†ã‚¹ãƒˆï¼ˆBase64ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸç”»åƒï¼‰
curl -X POST http://localhost:8080/ocr \
  -H "Content-Type: application/json" \
  -d '{"image_base64": "data:image/png;base64,iVBORw0KGgoAAAA..."}'
```

#### 1-3: Cloud Runãƒ‡ãƒ—ãƒ­ã‚¤

```bash
# GCPãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®š
gcloud config set project video-analyzer-v2

# Cloud Runãƒ‡ãƒ—ãƒ­ã‚¤
gcloud run deploy paddleocr-service \
  --source . \
  --region us-central1 \
  --platform managed \
  --allow-unauthenticated \
  --memory 2Gi \
  --cpu 2 \
  --timeout 300 \
  --max-instances 10 \
  --min-instances 0

# ãƒ‡ãƒ—ãƒ­ã‚¤URLå–å¾—ï¼ˆä¾‹: https://paddleocr-service-XXXXX.run.appï¼‰
```

---

### Phase 2: Video Analyzer Workerã®çµ±åˆï¼ˆDay 2ï¼‰

#### 2-1: ç’°å¢ƒå¤‰æ•°è¿½åŠ 

```bash
# Cloud Runç’°å¢ƒå¤‰æ•°ã«è¿½åŠ 
gcloud run services update video-analyzer-worker \
  --region us-central1 \
  --update-env-vars "PADDLEOCR_SERVICE_URL=https://paddleocr-service-XXXXX.run.app"
```

#### 2-2: PaddleOCRã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå®Ÿè£…

**æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ«**: `cloud-run-worker/src/services/paddleocrClient.ts`

```typescript
import axios from 'axios';

export interface PaddleOCRRequest {
  image_base64: string;
  confidence_threshold?: number;
}

export interface PaddleOCRResponse {
  text: string;
  confidence: number;
  details: Array<{
    text: string;
    confidence: number;
    bbox: number[][];
  }>;
}

export class PaddleOCRClient {
  private serviceUrl: string;

  constructor(serviceUrl?: string) {
    this.serviceUrl = serviceUrl || process.env.PADDLEOCR_SERVICE_URL || '';
    if (!this.serviceUrl) {
      throw new Error('PADDLEOCR_SERVICE_URL environment variable is not set');
    }
  }

  /**
   * Perform OCR on image using PaddleOCR service
   * @param imageBuffer - Image buffer (PNG/JPG)
   * @param confidenceThreshold - Minimum confidence (0-1)
   * @returns OCR result
   */
  async performOCR(
    imageBuffer: Buffer,
    confidenceThreshold: number = 0.5
  ): Promise<PaddleOCRResponse> {
    try {
      // Convert buffer to base64
      const base64Image = `data:image/png;base64,${imageBuffer.toString('base64')}`;

      // Call PaddleOCR service
      const response = await axios.post<PaddleOCRResponse>(
        `${this.serviceUrl}/ocr`,
        {
          image_base64: base64Image,
          confidence_threshold: confidenceThreshold
        },
        {
          timeout: 30000, // 30 seconds
          headers: {
            'Content-Type': 'application/json'
          }
        }
      );

      return response.data;
    } catch (error) {
      if (axios.isAxiosError(error)) {
        throw new Error(`PaddleOCR service error: ${error.message}`);
      }
      throw error;
    }
  }

  /**
   * Health check for PaddleOCR service
   * @returns true if healthy, false otherwise
   */
  async healthCheck(): Promise<boolean> {
    try {
      const response = await axios.get(`${this.serviceUrl}/health`, {
        timeout: 5000
      });
      return response.status === 200 && response.data.status === 'ok';
    } catch (error) {
      return false;
    }
  }
}
```

#### 2-3: pipeline.tsã®ä¿®æ­£ï¼ˆGemini â†’ PaddleOCRåˆ‡ã‚Šæ›¿ãˆï¼‰

**ä¿®æ­£ç®‡æ‰€**: `cloud-run-worker/src/services/pipeline.ts`

```typescript
// æ—¢å­˜ã®Gemini imports
import { GoogleGenerativeAI } from '@google/generative-ai';

// æ–°è¦è¿½åŠ : PaddleOCR client
import { PaddleOCRClient } from './paddleocrClient.js';

// ç’°å¢ƒå¤‰æ•°ã§åˆ‡ã‚Šæ›¿ãˆ
const USE_PADDLEOCR = process.env.USE_PADDLEOCR === 'true';

async function performSceneBasedOCR(scenes: Scene[], uploadId?: string): Promise<SceneWithOCR[]> {
  // Choose OCR engine based on environment variable
  if (USE_PADDLEOCR) {
    console.log('ğŸ”§ Using PaddleOCR for scene-based OCR');
    return performSceneBasedOCRWithPaddle(scenes, uploadId);
  } else {
    console.log('ğŸ”§ Using Gemini Vision for scene-based OCR');
    return performSceneBasedOCRWithGemini(scenes, uploadId);
  }
}

// Rename existing function
async function performSceneBasedOCRWithGemini(scenes: Scene[], uploadId?: string): Promise<SceneWithOCR[]> {
  // ... existing Gemini implementation ...
}

// New PaddleOCR implementation
async function performSceneBasedOCRWithPaddle(scenes: Scene[], uploadId?: string): Promise<SceneWithOCR[]> {
  const paddleClient = new PaddleOCRClient();

  // Health check
  const isHealthy = await paddleClient.healthCheck();
  if (!isHealthy) {
    console.error('âš ï¸ PaddleOCR service is not healthy, falling back to Gemini');
    return performSceneBasedOCRWithGemini(scenes, uploadId);
  }

  // Initialize parallel processing components
  const limit = pLimit(5);
  const rateLimiter = new RateLimiter(60); // 60 requests per minute (faster than Gemini)
  const progressReporter = uploadId ? new ProgressReporter(5) : null;

  let completedScenes = 0;
  const OCR_PROGRESS_START = 60;
  const OCR_PROGRESS_END = 85;
  const OCR_PROGRESS_RANGE = OCR_PROGRESS_END - OCR_PROGRESS_START;

  console.log(`  ğŸš€ Starting parallel OCR processing with PaddleOCR (${scenes.length} scenes, parallel degree: 5)`);
  const startTime = Date.now();

  // Process all scenes in parallel
  const results = await Promise.allSettled(
    scenes.map((scene, index) =>
      limit(async () => {
        if (!scene.screenshotPath) {
          console.log(`  âš ï¸ Scene ${scene.sceneNumber}: No screenshot, skipping OCR`);
          completedScenes++;
          return {
            ...scene,
            ocrText: '',
            ocrConfidence: 0
          };
        }

        const MAX_RETRIES = 3;
        const INITIAL_BACKOFF_MS = 1000; // 1 second (faster than Gemini)

        let lastError: Error | null = null;

        for (let attempt = 0; attempt <= MAX_RETRIES; attempt++) {
          try {
            await rateLimiter.acquire();

            // Read screenshot file
            const imageBuffer = fs.readFileSync(scene.screenshotPath);

            // Call PaddleOCR service
            const ocrResult = await paddleClient.performOCR(imageBuffer, 0.5);

            completedScenes++;

            // Report progress
            if (progressReporter && uploadId) {
              const progress = Math.floor(
                OCR_PROGRESS_START + (completedScenes / scenes.length) * OCR_PROGRESS_RANGE
              );
              await progressReporter.report(
                uploadId,
                progress,
                'ocr_processing',
                `OCR: ${completedScenes}/${scenes.length} scenes completed`
              );
            }

            // Enhanced logging
            const retryInfo = attempt > 0 ? ` (succeeded after ${attempt} retries)` : '';
            const textPreview = ocrResult.text.length > 0
              ? ocrResult.text.substring(0, 50).replace(/\n/g, ' ')
              : '(no text)';

            console.log(
              `  âœ“ Scene ${scene.sceneNumber}: OCR complete ` +
              `(text: ${ocrResult.text.length} chars, confidence: ${ocrResult.confidence.toFixed(2)})${retryInfo} ` +
              `[${completedScenes}/${scenes.length}]`
            );

            if (ocrResult.text.length > 0) {
              console.log(`    Preview: "${textPreview}${ocrResult.text.length > 50 ? '...' : ''}"`);
            } else {
              console.log(`    (No text detected)`);
            }

            if (ocrResult.confidence < 0.5 && ocrResult.text.length > 0) {
              console.warn(`  âš ï¸ Scene ${scene.sceneNumber}: Low confidence (${ocrResult.confidence.toFixed(2)})`);
            }

            return {
              ...scene,
              ocrText: ocrResult.text || '',
              ocrConfidence: ocrResult.confidence || 0
            };

          } catch (error) {
            lastError = error instanceof Error ? error : new Error(String(error));

            const isRetryable = lastError.message.includes('503') ||
                               lastError.message.includes('429') ||
                               lastError.message.includes('timeout');

            if (!isRetryable || attempt >= MAX_RETRIES) {
              console.error(`  âœ— Scene ${scene.sceneNumber}: OCR failed (attempt ${attempt + 1}/${MAX_RETRIES + 1})`);
              console.error(`    Error: ${lastError.message}`);
              break;
            }

            const backoffDelay = INITIAL_BACKOFF_MS * Math.pow(2, attempt);
            console.warn(
              `  âš ï¸  Scene ${scene.sceneNumber}: Temporary error (attempt ${attempt + 1}/${MAX_RETRIES + 1}), ` +
              `retrying after ${backoffDelay}ms...`
            );
            await new Promise(resolve => setTimeout(resolve, backoffDelay));
          }
        }

        completedScenes++;
        return {
          ...scene,
          ocrText: '',
          ocrConfidence: 0
        };
      })
    )
  );

  const duration = (Date.now() - startTime) / 1000;
  console.log(`  âœ“ Parallel OCR completed in ${duration.toFixed(2)}s`);
  console.log(`  ğŸ“Š Average: ${(duration / scenes.length).toFixed(2)}s per scene`);

  const scenesWithOCR: SceneWithOCR[] = results.map((result, index) => {
    if (result.status === 'fulfilled') {
      return result.value;
    } else {
      console.error(`  Scene ${scenes[index].sceneNumber} promise rejected:`, result.reason);
      return {
        ...scenes[index],
        ocrText: '',
        ocrConfidence: 0
      };
    }
  });

  if (progressReporter && uploadId) {
    await progressReporter.forceReport(uploadId, OCR_PROGRESS_END, 'ocr_completed', 'OCR processing completed');
  }

  console.log(`  âœ“ OCR complete: ${scenesWithOCR.filter(s => s.ocrText).length}/${scenes.length} scenes with text`);
  return scenesWithOCR;
}
```

---

## ğŸ§ª A/Bãƒ†ã‚¹ãƒˆæˆ¦ç•¥ï¼ˆæ®µéšçš„æ¤œè¨¼ï¼‰

### Phase 3: æ®µéšçš„ç§»è¡Œãƒ†ã‚¹ãƒˆ

**åŸºæœ¬æ–¹é‡**: æœ¬ç•ªãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã«å½±éŸ¿ã‚’ä¸ãˆãªã„ã‚ˆã†ã€æ…é‡ã«æ®µéšçš„æ¤œè¨¼ã‚’å®Ÿæ–½

---

### Stage 1: é–‹ç™ºç’°å¢ƒãƒ†ã‚¹ãƒˆï¼ˆãƒªã‚¹ã‚¯: ã‚¼ãƒ­ï¼‰

**ç›®çš„**: PaddleOCRåŸºæœ¬å‹•ä½œç¢ºèª
**æœŸé–“**: 1æ—¥
**ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯**: æœ¬ç•ªå½±éŸ¿ãªã—

**å®Ÿæ–½å†…å®¹**:
```bash
# ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§PaddleOCRã‚µãƒ¼ãƒ“ã‚¹ãƒ†ã‚¹ãƒˆ
cd paddleocr-service
docker build -t paddleocr-service .
docker run -p 8080:8080 paddleocr-service

# ãƒ†ã‚¹ãƒˆç”»åƒã§OCRå®Ÿè¡Œ
curl -X POST http://localhost:8080/ocr \
  -H "Content-Type: application/json" \
  -d '{"image_base64": "..."}'
```

**æˆåŠŸåŸºæº–**:
- [ ] Dockerãƒ“ãƒ«ãƒ‰æˆåŠŸ
- [ ] OCRãƒ¬ã‚¹ãƒãƒ³ã‚¹å–å¾—æˆåŠŸ
- [ ] æ—¥æœ¬èªãƒ†ã‚­ã‚¹ãƒˆæ­£å¸¸æŠ½å‡º

---

### Stage 2: ã‚¯ãƒ­ãƒ¼ã‚ºãƒ‰ãƒ™ãƒ¼ã‚¿ãƒ†ã‚¹ãƒˆï¼ˆãƒªã‚¹ã‚¯: æ¥µå°ï¼‰

**ç›®çš„**: å®Ÿéš›ã®å‹•ç”»ã§ã®ç²¾åº¦ãƒ»ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¤œè¨¼
**æœŸé–“**: 2-3æ—¥
**ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯**: ãƒ†ã‚¹ãƒˆå‹•ç”»ã®ã¿ï¼ˆæœ¬ç•ªãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å½±éŸ¿ãªã—ï¼‰

**å®Ÿæ–½å†…å®¹**:
1. PaddleOCRã‚µãƒ¼ãƒ“ã‚¹ã‚’Cloud Runã«ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆæœ¬ç•ªç’°å¢ƒã¨ã¯ç‹¬ç«‹ï¼‰
2. ãƒ†ã‚¹ãƒˆç”¨Cloud Run Workerã‚’èµ·å‹•ï¼ˆ`USE_PADDLEOCR=true`ï¼‰
3. 5æœ¬ã®ãƒ†ã‚¹ãƒˆå‹•ç”»ã§æ¤œè¨¼

**ãƒ†ã‚¹ãƒˆç”¨å‹•ç”»ã‚»ãƒƒãƒˆ**:
| # | å‹•ç”»ã‚¿ã‚¤ãƒ— | ãƒ†ã‚¹ãƒˆç›®çš„ | æœŸå¾…æ¤œå‡ºç‡ |
|---|----------|----------|-----------|
| 1 | æ—¥æœ¬èªãƒ†ãƒ­ãƒƒãƒ—ï¼ˆä¸‹æ®µå­—å¹•ï¼‰ | æ—¥æœ¬èªç²¾åº¦ç¢ºèª | 95%+ |
| 2 | è‹±èªã‚¿ã‚¤ãƒˆãƒ«ï¼ˆä¸­å¤®ï¼‰ | è‹±èªç²¾åº¦ç¢ºèª | 90%+ |
| 3 | æ—¥è‹±æ··åœ¨ï¼ˆYouTubeå½¢å¼ï¼‰ | æ··åœ¨ãƒ†ã‚­ã‚¹ãƒˆå‡¦ç† | 90%+ |
| 4 | å°ã•ã„ãƒ†ã‚­ã‚¹ãƒˆï¼ˆ4Kâ†’1080pï¼‰ | ç¸®å°ç”»åƒç²¾åº¦ | 85%+ |
| 5 | ç¸¦å‹•ç”»ï¼ˆTikTokå½¢å¼ï¼‰ | ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”å¯¾å¿œ | 90%+ |

**æ¯”è¼ƒæŒ‡æ¨™**:
| æŒ‡æ¨™ | Geminiï¼ˆç¾çŠ¶ï¼‰ | PaddleOCRï¼ˆç›®æ¨™ï¼‰ | åˆ¤å®šåŸºæº– |
|------|---------------|-----------------|---------|
| **æ¤œå‡ºç‡** | 85-90% | â‰¥90% | åŒç­‰ä»¥ä¸Š |
| **ç²¾åº¦ï¼ˆæ­£ç¢ºæ€§ï¼‰** | 90% | â‰¥90% | åŒç­‰ä»¥ä¸Š |
| **å‡¦ç†æ™‚é–“/ã‚·ãƒ¼ãƒ³** | 2-3ç§’ | â‰¤2ç§’ | 1.5å€ä»¥å†… |
| **å¹³å‡Confidence** | 0.7-0.8 | â‰¥0.7 | åŒç­‰ä»¥ä¸Š |
| **ã‚¨ãƒ©ãƒ¼ãƒ¬ãƒ¼ãƒˆ** | 2-3% | â‰¤5% | è¨±å®¹ç¯„å›²å†… |

**æˆåŠŸåŸºæº–**:
- [ ] 5æœ¬ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆå‹•ç”»ã§æ¤œå‡ºç‡90%ä»¥ä¸Š
- [ ] Geminiã¨åŒç­‰ä»¥ä¸Šã®ç²¾åº¦
- [ ] å‡¦ç†æ™‚é–“ãŒGeminiã®1.5å€ä»¥å†…
- [ ] ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«ã‚¨ãƒ©ãƒ¼ãªã—

**å¤±æ•—æ™‚ã®å¯¾å¿œ**: ã“ã®æ®µéšã§å¤±æ•—ã—ãŸå ´åˆã€å®Ÿè£…ã‚’ä¸­æ­¢ã—ã€åŸå› åˆ†æå¾Œã«å†æ¤œè¨

---

### Stage 3: Shadow Traffic A/Bãƒ†ã‚¹ãƒˆï¼ˆãƒªã‚¹ã‚¯: å°ï¼‰

**ç›®çš„**: æœ¬ç•ªãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã§ã®ç²¾åº¦ãƒ»å®‰å®šæ€§æ¤œè¨¼ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¯å½±éŸ¿ãªã—ï¼‰
**æœŸé–“**: 3-5æ—¥
**ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯**: æœ¬ç•ªãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã®**ãƒ­ã‚°ã®ã¿**ï¼ˆçµæœã¯ç ´æ£„ï¼‰

**å®Ÿæ–½æ–¹æ³•**:
1. æœ¬ç•ªVideo Analyzer Workerã§ã€Gemini **ã¨** PaddleOCR **ä¸¡æ–¹** ã‚’å®Ÿè¡Œ
2. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¯Geminiã®çµæœã®ã¿ã‚’è¿”ã™
3. PaddleOCRã®çµæœã¯ãƒ­ã‚°ã«è¨˜éŒ²ã—ã€æ¯”è¼ƒåˆ†æ

**å®Ÿè£…ä¾‹**:
```typescript
// pipeline.ts ã®ä¿®æ­£
async function performSceneBasedOCR(scenes: Scene[], uploadId?: string): Promise<SceneWithOCR[]> {
  const USE_SHADOW_AB_TEST = process.env.SHADOW_AB_TEST === 'true';

  if (USE_SHADOW_AB_TEST) {
    // A/Bãƒ†ã‚¹ãƒˆãƒ¢ãƒ¼ãƒ‰: ä¸¡æ–¹å®Ÿè¡Œ
    const [geminiResults, paddleResults] = await Promise.all([
      performSceneBasedOCRWithGemini(scenes, uploadId),
      performSceneBasedOCRWithPaddle(scenes, uploadId)
    ]);

    // æ¯”è¼ƒãƒ­ã‚°å‡ºåŠ›
    logABTestComparison(geminiResults, paddleResults);

    // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¯Geminiã®çµæœã®ã¿ã‚’è¿”ã™
    return geminiResults;
  } else {
    // é€šå¸¸ãƒ¢ãƒ¼ãƒ‰
    return performSceneBasedOCRWithGemini(scenes, uploadId);
  }
}
```

**æ¯”è¼ƒåˆ†æå†…å®¹**:
- æ¤œå‡ºç‡ã®å·®ç•°ï¼ˆã‚·ãƒ¼ãƒ³å˜ä½ï¼‰
- Confidenceã‚¹ã‚³ã‚¢ã®åˆ†å¸ƒ
- ãƒ†ã‚­ã‚¹ãƒˆå†…å®¹ã®ä¸€è‡´ç‡
- å‡¦ç†æ™‚é–“ã®å·®ç•°
- ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿé »åº¦

**æˆåŠŸåŸºæº–**:
- [ ] æœ¬ç•ªå‹•ç”»100æœ¬ä»¥ä¸Šã§æ¤œè¨¼
- [ ] PaddleOCRã®æ¤œå‡ºç‡ãŒGeminiã®95%ä»¥ä¸Š
- [ ] PaddleOCRã®ã‚¨ãƒ©ãƒ¼ãƒ¬ãƒ¼ãƒˆ â‰¤ 5%
- [ ] é‡å¤§ãªãƒã‚°ãƒ»ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ãªã—

**Go/No-Goåˆ¤å®š**:
- **Go**: ä¸Šè¨˜æˆåŠŸåŸºæº–ã™ã¹ã¦ã‚¯ãƒªã‚¢ â†’ Stage 4ã¸é€²ã‚€
- **No-Go**: 1ã¤ã§ã‚‚å¤±æ•— â†’ åŸå› åˆ†æãƒ»ä¿®æ­£å¾Œã€Stage 2ã‹ã‚‰ã‚„ã‚Šç›´ã—

---

### Stage 4: Canary Deploymentï¼ˆãƒªã‚¹ã‚¯: ä¸­ï¼‰

**ç›®çš„**: å®Ÿéš›ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã§ã®å‹•ä½œç¢ºèª
**æœŸé–“**: 3-7æ—¥
**ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯**: æœ¬ç•ªãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã®**10%**ã‚’PaddleOCRã§å‡¦ç†

**å®Ÿæ–½æ–¹æ³•**:
```bash
# ç’°å¢ƒå¤‰æ•°ã§ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯åˆ†å‰²æ¯”ç‡ã‚’è¨­å®š
gcloud run services update video-analyzer-worker \
  --region us-central1 \
  --update-env-vars "USE_PADDLEOCR=true,PADDLEOCR_TRAFFIC_PERCENTAGE=10"
```

**å®Ÿè£…ä¾‹**:
```typescript
async function performSceneBasedOCR(scenes: Scene[], uploadId?: string): Promise<SceneWithOCR[]> {
  const USE_PADDLEOCR = process.env.USE_PADDLEOCR === 'true';
  const TRAFFIC_PERCENTAGE = parseInt(process.env.PADDLEOCR_TRAFFIC_PERCENTAGE || '0');

  // ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯åˆ†å‰²ï¼ˆãƒ©ãƒ³ãƒ€ãƒ ï¼‰
  const usePaddle = USE_PADDLEOCR && (Math.random() * 100 < TRAFFIC_PERCENTAGE);

  if (usePaddle) {
    console.log('ğŸ”§ Using PaddleOCR (Canary traffic)');
    return performSceneBasedOCRWithPaddle(scenes, uploadId);
  } else {
    console.log('ğŸ”§ Using Gemini Vision (Stable traffic)');
    return performSceneBasedOCRWithGemini(scenes, uploadId);
  }
}
```

**ç›£è¦–é …ç›®**:
| æŒ‡æ¨™ | ã‚¢ãƒ©ãƒ¼ãƒˆé–¾å€¤ | å¯¾å¿œ |
|------|-----------|------|
| ã‚¨ãƒ©ãƒ¼ãƒ¬ãƒ¼ãƒˆ | > 10% | å³åº§ã«ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ |
| å¹³å‡å‡¦ç†æ™‚é–“ | > Geminiã®2å€ | ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯5%ã«å‰Šæ¸› |
| ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¯ãƒ¬ãƒ¼ãƒ  | 1ä»¶ä»¥ä¸Š | åŸå› èª¿æŸ»ã€å¿…è¦ã«å¿œã˜ã¦ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ |
| Cloud Runãƒ¡ãƒ¢ãƒªä½¿ç”¨ç‡ | > 90% | ãƒ¡ãƒ¢ãƒªå¢—å¼· |

**æ®µéšçš„ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯å¢—åŠ **:
- Day 1-2: 10%
- Day 3-4: 25%ï¼ˆå•é¡Œãªã‘ã‚Œã°ï¼‰
- Day 5-7: 50%ï¼ˆå•é¡Œãªã‘ã‚Œã°ï¼‰

**æˆåŠŸåŸºæº–**:
- [ ] 7æ—¥é–“ã€ä¸Šè¨˜ã‚¢ãƒ©ãƒ¼ãƒˆé–¾å€¤ã‚’è¶…ãˆãªã„
- [ ] ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¯ãƒ¬ãƒ¼ãƒ ã‚¼ãƒ­
- [ ] Geminiã¨åŒç­‰ã®ã‚µãƒ¼ãƒ“ã‚¹å“è³ª

**Go/No-Goåˆ¤å®š**:
- **Go**: æˆåŠŸåŸºæº–ã‚¯ãƒªã‚¢ â†’ Stage 5ã¸é€²ã‚€
- **No-Go**: ã‚¢ãƒ©ãƒ¼ãƒˆç™ºç”Ÿ â†’ ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯æ¯”ç‡ã‚’ä¸‹ã’ã‚‹ã‹ã€ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯

---

### Stage 5: æ®µéšçš„å®Œå…¨ç§»è¡Œï¼ˆãƒªã‚¹ã‚¯: ä¸­ã€œé«˜ï¼‰

**ç›®çš„**: PaddleOCRã¸ã®å®Œå…¨ç§»è¡Œ
**æœŸé–“**: 7-14æ—¥
**ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯**: 100%

**å®Ÿæ–½æ–¹æ³•**:
```bash
# ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯æ¯”ç‡ã‚’æ®µéšçš„ã«å¢—åŠ 
gcloud run services update video-analyzer-worker \
  --region us-central1 \
  --update-env-vars "PADDLEOCR_TRAFFIC_PERCENTAGE=100"
```

**æ®µéšçš„å¢—åŠ ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«**:
| æœŸé–“ | ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯æ¯”ç‡ | ç›£è¦–å¼·åº¦ |
|------|---------------|---------|
| Day 1-3 | 75% | 1æ™‚é–“ã”ã¨ã«ãƒ­ã‚°ç¢ºèª |
| Day 4-7 | 100% | 4æ™‚é–“ã”ã¨ã«ãƒ­ã‚°ç¢ºèª |
| Day 8-14 | 100% | 1æ—¥1å›ãƒ­ã‚°ç¢ºèª |

**æˆåŠŸåŸºæº–**:
- [ ] 14æ—¥é–“ã€é‡å¤§ãªã‚¨ãƒ©ãƒ¼ãªã—
- [ ] æœˆé–“ã‚³ã‚¹ãƒˆå‰Šæ¸›ã‚’ç¢ºèªï¼ˆÂ¥19,000/æœˆï¼‰
- [ ] ãƒ¦ãƒ¼ã‚¶ãƒ¼æº€è¶³åº¦ç¶­æŒï¼ˆã‚¯ãƒ¬ãƒ¼ãƒ ãªã—ï¼‰

**å®Œå…¨ç§»è¡Œå¾Œã®å¯¾å¿œ**:
- **2é€±é–“å¾Œ**: Geminiã‚³ãƒ¼ãƒ‰ã‚’å‰Šé™¤ã›ãšã€ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿèƒ½ã¨ã—ã¦æ®‹ã™
- **1ãƒ¶æœˆå¾Œ**: Geminiå®Œå…¨å»ƒæ­¢ã‚’æ¤œè¨ï¼ˆç’°å¢ƒå¤‰æ•°å‰Šé™¤ã€ã‚³ãƒ¼ãƒ‰å‰Šé™¤ï¼‰

---

### Stage 6: Geminiå®Œå…¨å»ƒæ­¢ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

**ç›®çš„**: ã‚³ãƒ¼ãƒ‰ç°¡ç´ åŒ–ã€ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹è² è·å‰Šæ¸›
**æœŸé–“**: å®Ÿè£…1æ—¥
**å‰ææ¡ä»¶**: Stage 5å®Œäº†å¾Œã€1ãƒ¶æœˆä»¥ä¸Šå•é¡Œãªã—

**å®Ÿæ–½å†…å®¹**:
1. `performSceneBasedOCRWithGemini`é–¢æ•°å‰Šé™¤
2. `USE_PADDLEOCR`ç’°å¢ƒå¤‰æ•°å‰Šé™¤ï¼ˆPaddleOCRãŒæ¨™æº–ã«ï¼‰
3. Geminié–¢é€£ã®ä¾å­˜é–¢ä¿‚å‰Šé™¤ï¼ˆ`@google/generative-ai`ï¼‰
4. ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°

**æ³¨æ„**: ã“ã®æ®µéšã¯**ã‚ªãƒ—ã‚·ãƒ§ãƒ³**ã§ã™ã€‚ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿèƒ½ã‚’æ®‹ã™ã“ã¨ã‚‚æ¤œè¨ã—ã¦ãã ã•ã„ã€‚

---

### ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æº–å‚™ï¼ˆå…¨Stageå…±é€šï¼‰

```bash
# å•é¡Œç™ºç”Ÿæ™‚: å³åº§ã«Geminiã«æˆ»ã™
gcloud run services update video-analyzer-worker \
  --region us-central1 \
  --update-env-vars "USE_PADDLEOCR=false"

# ã¾ãŸã¯: å‰ã®ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã«æˆ»ã™
gcloud run services update-traffic video-analyzer-worker \
  --to-revisions=PREVIOUS_REVISION=100 \
  --region us-central1
```

---

## ğŸ’° ã‚³ã‚¹ãƒˆåˆ†æ

### ç¾çŠ¶ï¼ˆGemini Vision APIï¼‰

| é …ç›® | æœˆé–“ä½¿ç”¨é‡ | å˜ä¾¡ | æœˆé¡ã‚³ã‚¹ãƒˆ |
|------|-----------|------|-----------|
| Gemini APIå‘¼ã³å‡ºã— | 100,000ç”»åƒ | Â¥212/1000ç”»åƒ | Â¥21,200 |
| Cloud Runå®Ÿè¡Œæ™‚é–“ | å«ã‚€ | - | Â¥0 |
| **åˆè¨ˆ** | - | - | **Â¥21,200** |

### æ–°æ–¹å¼ï¼ˆPaddleOCRï¼‰

| é …ç›® | æœˆé–“ä½¿ç”¨é‡ | å˜ä¾¡ | æœˆé¡ã‚³ã‚¹ãƒˆ |
|------|-----------|------|-----------|
| PaddleOCR APIå‘¼ã³å‡ºã— | 100,000ç”»åƒ | **Â¥0** | **Â¥0** |
| PaddleOCR Cloud Runå®Ÿè¡Œæ™‚é–“ | ç´„500æ™‚é–“ | Â¥4/æ™‚é–“ | Â¥2,000 |
| Video Analyzerå®Ÿè¡Œæ™‚é–“ | å¤‰åŒ–ãªã— | - | Â¥0 |
| **åˆè¨ˆ** | - | - | **Â¥2,000** |

**å¹´é–“ã‚³ã‚¹ãƒˆå‰Šæ¸›**: Â¥21,200 Ã— 12 - Â¥2,000 Ã— 12 = **Â¥230,400**

---

## ğŸ“ˆ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹äºˆæ¸¬

### å‡¦ç†æ™‚é–“æ¯”è¼ƒ

| OCRã‚¨ãƒ³ã‚¸ãƒ³ | 1ç”»åƒã‚ãŸã‚Šå‡¦ç†æ™‚é–“ | 100ç”»åƒå‡¦ç†æ™‚é–“ | ä¸¦åˆ—åº¦ |
|------------|------------------|---------------|-------|
| **Gemini Vision** | 2-3ç§’ | 200-300ç§’ | 5ä¸¦åˆ— |
| **PaddleOCR (CPU)** | 1-2ç§’ | 100-200ç§’ | 5ä¸¦åˆ— |
| **PaddleOCR (GPU)** | 0.5-1ç§’ | 50-100ç§’ | 10ä¸¦åˆ— |

**çµè«–**: PaddleOCRã®æ–¹ãŒ1.5-2å€é«˜é€Ÿï¼ˆCPUãƒ¢ãƒ¼ãƒ‰ï¼‰

### ç²¾åº¦æ¯”è¼ƒï¼ˆæ¨å®šï¼‰

| OCRã‚¨ãƒ³ã‚¸ãƒ³ | æ—¥æœ¬èªç²¾åº¦ | è‹±èªç²¾åº¦ | å°ã•ã„æ–‡å­— | æ›²ãŒã£ãŸãƒ†ã‚­ã‚¹ãƒˆ |
|------------|-----------|---------|-----------|---------------|
| **Gemini Vision** | 85-90% | 95% | 80% | 85% |
| **PaddleOCR** | **90-95%** | 95% | **90%** | **95%** |

**çµè«–**: PaddleOCRã®æ–¹ãŒæ—¥æœ¬èªã¨ç‰¹æ®Šã‚±ãƒ¼ã‚¹ã«å¼·ã„

---

## ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è€ƒæ…®äº‹é …

### 1. å†…éƒ¨é€šä¿¡ã®ã¿ï¼ˆCloud Run â†’ Cloud Runï¼‰
- **HTTPSå¿…é ˆ**: Cloud Runé–“é€šä¿¡ã¯HTTPSå¼·åˆ¶
- **èªè¨¼ã‚ªãƒ—ã‚·ãƒ§ãƒ³**: Cloud Run IAMãƒ™ãƒ¼ã‚¹ã®èªè¨¼ã‚‚å¯èƒ½ï¼ˆç¾åœ¨ã¯`--allow-unauthenticated`ï¼‰

### 2. æ©Ÿå¯†ãƒ‡ãƒ¼ã‚¿ã®æ‰±ã„
- **ç”»åƒãƒ‡ãƒ¼ã‚¿**: Base64ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã§è»¢é€ã€å‡¦ç†å¾Œã™ãã«ç ´æ£„
- **ãƒ­ã‚°å‡ºåŠ›**: ç”»åƒãƒ‡ãƒ¼ã‚¿ã¯ãƒ­ã‚°ã«å‡ºåŠ›ã—ãªã„

### 3. ãƒ¬ãƒ¼ãƒˆåˆ¶é™
- **DDoså¯¾ç­–**: Cloud Runã®Concurrencyè¨­å®šã§åŒæ™‚å®Ÿè¡Œæ•°ã‚’åˆ¶é™
- **å†…éƒ¨ãƒ¬ãƒ¼ãƒˆåˆ¶é™**: RateLimiterï¼ˆ60req/minï¼‰ã§è² è·åˆ†æ•£

---

## ğŸš¨ ãƒªã‚¹ã‚¯ã¨å¯¾ç­–

### ãƒªã‚¹ã‚¯1: PaddleOCRã‚µãƒ¼ãƒ“ã‚¹ã®éšœå®³
**å¯¾ç­–**: Geminiã¸ã®è‡ªå‹•ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿèƒ½å®Ÿè£…æ¸ˆã¿
```typescript
const isHealthy = await paddleClient.healthCheck();
if (!isHealthy) {
  console.error('âš ï¸ PaddleOCR service is not healthy, falling back to Gemini');
  return performSceneBasedOCRWithGemini(scenes, uploadId);
}
```

### ãƒªã‚¹ã‚¯2: Cloud Run Cold Startï¼ˆã‚³ãƒ¼ãƒ«ãƒ‰ã‚¹ã‚¿ãƒ¼ãƒˆï¼‰
**å½±éŸ¿**: åˆå›ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒ10-15ç§’é…å»¶
**å¯¾ç­–**:
- `--min-instances 1`ã§å¸¸æ™‚1ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹èµ·å‹•ï¼ˆæœˆé¡ã‚³ã‚¹ãƒˆ+Â¥1,000ï¼‰
- ã¾ãŸã¯ã€å®šæœŸçš„ãªHealth Check Pingã§ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ç¶­æŒ

### ãƒªã‚¹ã‚¯3: ãƒ¡ãƒ¢ãƒªä¸è¶³
**å½±éŸ¿**: å¤§å®¹é‡ç”»åƒï¼ˆ4Kï¼‰å‡¦ç†æ™‚ã«OOMï¼ˆOut of Memoryï¼‰
**å¯¾ç­–**:
- `--memory 2Gi`è¨­å®šï¼ˆç¾åœ¨ã¨åŒã˜ï¼‰
- ç”»åƒãƒªã‚µã‚¤ã‚ºï¼ˆ1920x1080ä»¥ä¸‹ï¼‰ã¯æ—¢ã«å®Ÿè£…æ¸ˆã¿

### ãƒªã‚¹ã‚¯4: å‡¦ç†æ™‚é–“è¶…é
**å½±éŸ¿**: Cloud Run timeoutï¼ˆ300ç§’ï¼‰
**å¯¾ç­–**:
- PaddleOCRã®æ–¹ãŒé«˜é€ŸãªãŸã‚ã€ãƒªã‚¹ã‚¯ã¯ä½ã„
- ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆè¨­å®šã¯æ—¢å­˜ã¨åŒã˜ï¼ˆ300ç§’ï¼‰

---

## ğŸ“ ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³

### Week 1: é–‹ç™ºãƒ»ãƒ†ã‚¹ãƒˆ
- **Day 1**: PaddleOCR Serviceæ§‹ç¯‰ãƒ»ãƒ­ãƒ¼ã‚«ãƒ«ãƒ†ã‚¹ãƒˆãƒ»Cloud Runãƒ‡ãƒ—ãƒ­ã‚¤
- **Day 2**: Video Analyzerçµ±åˆãƒ»ãƒ†ã‚¹ãƒˆå‹•ç”»æ¤œè¨¼
- **Day 3**: A/Bãƒ†ã‚¹ãƒˆãƒ»ç²¾åº¦æ¯”è¼ƒãƒ»ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¸¬å®š

### Week 2: æœ¬ç•ªç§»è¡Œ
- **Day 4-5**: Canary Deploymentï¼ˆ10%ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ï¼‰
- **Day 6-7**: æœ¬ç•ªç§»è¡Œï¼ˆ100%ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ï¼‰ãƒ»24æ™‚é–“ç›£è¦–

### Week 3: æœ€é©åŒ–
- **Day 8-10**: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ãƒ»ãƒ­ã‚°åˆ†æãƒ»ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆ

---

## ğŸ¯ æˆåŠŸåŸºæº–

### å¿…é ˆæ¡ä»¶ï¼ˆGo/No-Goï¼‰
- [ ] OCRæ¤œå‡ºç‡ â‰¥ 90%ï¼ˆGeminiã¨åŒç­‰ä»¥ä¸Šï¼‰
- [ ] å‡¦ç†æ™‚é–“ â‰¤ Geminiï¼ˆ1.5å€ä»¥å†…ï¼‰
- [ ] ã‚¨ãƒ©ãƒ¼ãƒ¬ãƒ¼ãƒˆ â‰¤ 5%
- [ ] æœˆé¡ã‚³ã‚¹ãƒˆ â‰¤ Â¥3,000

### ç†æƒ³æ¡ä»¶
- [ ] OCRæ¤œå‡ºç‡ â‰¥ 95%
- [ ] å‡¦ç†æ™‚é–“ â‰¤ Geminiã®0.5å€ï¼ˆ2å€é«˜é€Ÿï¼‰
- [ ] ã‚¨ãƒ©ãƒ¼ãƒ¬ãƒ¼ãƒˆ â‰¤ 1%
- [ ] æœˆé¡ã‚³ã‚¹ãƒˆ â‰¤ Â¥2,000

---

## ğŸ“š å‚è€ƒè³‡æ–™

### PaddleOCRå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- GitHub: https://github.com/PaddlePaddle/PaddleOCR
- ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ: https://paddlepaddle.github.io/PaddleOCR/
- æ—¥æœ¬èªãƒ¢ãƒ‡ãƒ«: https://github.com/PaddlePaddle/PaddleOCR/blob/release/2.7/doc/doc_en/models_list_en.md#3-multilingual-recognition-model

### Cloud Run ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹
- å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ: https://cloud.google.com/run/docs/tips
- FastAPI + Cloud Run: https://cloud.google.com/run/docs/quickstarts/build-and-deploy/deploy-python-service

### å†…éƒ¨å‚ç…§
- ç¾åœ¨ã®å®Ÿè£…: `cloud-run-worker/src/services/pipeline.ts`
- FFmpegè¨­å®š: `cloud-run-worker/src/services/ffmpeg.ts`
- ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£: `SYSTEM_ARCHITECTURE_2025-11-04.md`

---

## ğŸ”„ æ„æ€æ±ºå®šãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯

### å®Ÿè£…é–‹å§‹ã®ãŸã‚ã®æ‰¿èªãƒ—ãƒ­ã‚»ã‚¹

**Step 1: ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ãƒ¬ãƒ“ãƒ¥ãƒ¼**
- [ ] ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã“ã®å®Ÿè£…è¨ˆç”»ã‚’èª­ã¿ã€ç†è§£ã™ã‚‹
- [ ] A/Bãƒ†ã‚¹ãƒˆæˆ¦ç•¥ã«åŒæ„ã™ã‚‹
- [ ] ãƒªã‚¹ã‚¯ã¨å¯¾ç­–ã‚’ç†è§£ã™ã‚‹

**Step 2: æ„æ€æ±ºå®šäº‹é …ã®ç¢ºèª**

ä»¥ä¸‹ã®è³ªå•ã«å¯¾ã™ã‚‹å›ç­”ã‚’æ±ºå®šã—ã¦ãã ã•ã„ï¼š

| è³ªå• | é¸æŠè‚¢ | æ¨å¥¨ | å½±éŸ¿ |
|------|-------|------|------|
| **Q1**: PaddleOCRã‚µãƒ¼ãƒ“ã‚¹ã«`--min-instances 1`ã‚’è¨­å®šã™ã‚‹ã‹ï¼Ÿ | Yes / No | **No**ï¼ˆåˆæœŸã¯ã‚³ã‚¹ãƒˆå„ªå…ˆï¼‰ | +Â¥1,000/æœˆã€Cold Startå›é¿ |
| **Q2**: GPUæœ‰åŠ¹åŒ–ã™ã‚‹ã‹ï¼Ÿ | Yes / No | **No**ï¼ˆCPUååˆ†é«˜é€Ÿï¼‰ | +Â¥10,000/æœˆã€å‡¦ç†3å€é«˜é€Ÿ |
| **Q3**: Shadow A/Bãƒ†ã‚¹ãƒˆï¼ˆStage 3ï¼‰ã‚’å®Ÿæ–½ã™ã‚‹ã‹ï¼Ÿ | Yes / No | **Yes**ï¼ˆãƒªã‚¹ã‚¯ä½æ¸›ï¼‰ | +3-5æ—¥ã€ç²¾åº¦æ¤œè¨¼ |
| **Q4**: Geminiå®Œå…¨å»ƒæ­¢ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã¯ï¼Ÿ | 1ãƒ¶æœˆå¾Œ / 3ãƒ¶æœˆå¾Œ / å»ƒæ­¢ã—ãªã„ | **3ãƒ¶æœˆå¾Œ**ï¼ˆå®‰å…¨é‡è¦–ï¼‰ | ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ç¶­æŒ |

**Step 3: æ˜ç¤ºçš„ãªå®Ÿè£…GOæŒ‡ç¤º**

ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä»¥ä¸‹ã®ã„ãšã‚Œã‹ã®æ–¹æ³•ã§æ‰¿èªã‚’è¡¨æ˜ã—ã¦ãã ã•ã„ï¼š

```
æ‰¿èªä¾‹1:
ã€ŒPaddleOCRå®Ÿè£…ã‚’é–‹å§‹ã—ã¦ãã ã•ã„ã€‚Q1=No, Q2=No, Q3=Yes, Q4=3ãƒ¶æœˆå¾Œã§é€²ã‚ã¦ãã ã•ã„ã€‚ã€

æ‰¿èªä¾‹2:
ã€ŒPADDLEOCR_IMPLEMENTATION_PLAN.mdã®å†…å®¹ã§å®Ÿè£…GOã§ã™ã€‚æ¨å¥¨è¨­å®šã§é€²ã‚ã¦ãã ã•ã„ã€‚ã€

æ‰¿èªä¾‹3:
ã€ŒPaddleOCRå®Ÿè£…ã‚¹ã‚¿ãƒ¼ãƒˆã—ã¦ãã ã•ã„ã€‚ã€
```

**Step 4: å®Ÿè£…é–‹å§‹**

æ‰¿èªå¾Œã€ä»¥ä¸‹ã®é †åºã§å®Ÿè£…ã‚’é–‹å§‹ã—ã¾ã™ï¼š
1. Stage 1ï¼ˆé–‹ç™ºç’°å¢ƒãƒ†ã‚¹ãƒˆï¼‰
2. Stage 2ï¼ˆã‚¯ãƒ­ãƒ¼ã‚ºãƒ‰ãƒ™ãƒ¼ã‚¿ãƒ†ã‚¹ãƒˆï¼‰
3. Stage 3ï¼ˆShadow A/Bãƒ†ã‚¹ãƒˆï¼‰- Q3=Yesã®å ´åˆã®ã¿
4. Stage 4ï¼ˆCanary Deploymentï¼‰
5. Stage 5ï¼ˆæ®µéšçš„å®Œå…¨ç§»è¡Œï¼‰
6. Stage 6ï¼ˆGeminiå®Œå…¨å»ƒæ­¢ï¼‰- Q4ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§å®Ÿæ–½

---

## ğŸ“‹ ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ: å®Ÿè£…å‰ã®ç¢ºèªäº‹é …

### æŠ€è¡“çš„æº–å‚™
- [ ] Cloud Run ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼ˆvideo-analyzer-prod-1756704391ï¼‰ã®ã‚¯ã‚©ãƒ¼ã‚¿ç¢ºèª
- [ ] Cloud Runæ–™é‡‘ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®šï¼ˆæœˆÂ¥5,000è¶…éæ™‚ã«é€šçŸ¥ï¼‰
- [ ] Supabaseã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸å®¹é‡ç¢ºèªï¼ˆãƒ†ã‚¹ãƒˆå‹•ç”»ä¿å­˜ç”¨ï¼‰
- [ ] ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒã«Dockerç’°å¢ƒã‚ã‚Š

### ãƒªã‚½ãƒ¼ã‚¹ç¢ºä¿
- [ ] å®Ÿè£…æ™‚é–“ã®ç¢ºä¿ï¼ˆWeek 1: 3æ—¥é–“ï¼‰
- [ ] ãƒ†ã‚¹ãƒˆå‹•ç”»5æœ¬ã®æº–å‚™
- [ ] ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°æ™‚é–“ã®ç¢ºä¿ï¼ˆWeek 2-3: 1æ—¥30åˆ†ç¨‹åº¦ï¼‰

### ãƒªã‚¹ã‚¯ç†è§£
- [ ] PaddleOCRéšœå®³æ™‚ã®Geminiãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿèƒ½ã‚’ç†è§£
- [ ] ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ‰‹é †ã‚’ç†è§£
- [ ] æœ€æ‚ªã‚±ãƒ¼ã‚¹ã®ã‚·ãƒŠãƒªã‚ªã‚’ç†è§£ï¼ˆå…¨é¢ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã€Geminiç¶™ç¶šä½¿ç”¨ï¼‰

---

## ğŸš¨ å®Ÿè£…ä¸­æ­¢æ¡ä»¶

ä»¥ä¸‹ã®ã„ãšã‚Œã‹ã«è©²å½“ã™ã‚‹å ´åˆã€å®Ÿè£…ã‚’ä¸­æ­¢ã—ã€Geminiã«æˆ»ã—ã¾ã™ï¼š

1. **Stage 2ã§æ¤œå‡ºç‡85%æœªæº€**
2. **Stage 3ã§ã‚¨ãƒ©ãƒ¼ãƒ¬ãƒ¼ãƒˆ10%è¶…é**
3. **Stage 4ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¯ãƒ¬ãƒ¼ãƒ 2ä»¶ä»¥ä¸Š**
4. **äºˆç®—è¶…é**ï¼ˆæœˆé¡ã‚³ã‚¹ãƒˆÂ¥5,000è¶…éï¼‰
5. **ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®ä¸­æ­¢æŒ‡ç¤º**

ä¸­æ­¢æ™‚ã®å¯¾å¿œï¼š
- å³åº§ã«Geminiã«æˆ»ã™ï¼ˆç’°å¢ƒå¤‰æ•°å¤‰æ›´ã®ã¿ã€5åˆ†ä»¥å†…ï¼‰
- åŸå› åˆ†æãƒ¬ãƒãƒ¼ãƒˆä½œæˆ
- å†å®Ÿè£…ã®å¯å¦ã‚’åˆ¤æ–­

---

## ğŸ“ ã‚µãƒãƒ¼ãƒˆãƒ»è³ªå•

### å®Ÿè£…ä¸­ã®ç›¸è«‡
å®Ÿè£…ä¸­ã«ä¸æ˜ç‚¹ã‚„å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆã€ä»¥ä¸‹ã®æƒ…å ±ã‚’æ·»ãˆã¦ç›¸è«‡ã—ã¦ãã ã•ã„ï¼š
- ç¾åœ¨ã®Stageç•ªå·
- ç™ºç”Ÿã—ãŸå•é¡Œã®è©³ç´°
- Cloud Runãƒ­ã‚°ã®æŠœç²‹
- æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œã¨å®Ÿéš›ã®å‹•ä½œ

### å‚è€ƒãƒªã‚½ãƒ¼ã‚¹
- PaddleOCRå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ: https://github.com/PaddlePaddle/PaddleOCR
- Cloud Runå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ: https://cloud.google.com/run/docs
- ç¾åœ¨ã®å®Ÿè£…: `cloud-run-worker/src/services/pipeline.ts`
- ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£: `SYSTEM_ARCHITECTURE_2025-11-04.md`

---

## ğŸ”„ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

### ç¾åœ¨ã®çŠ¶æ…‹: ğŸ“‹ **è¨ˆç”»æ®µéš**

**ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®æ˜ç¤ºçš„ãªå®Ÿè£…GOæŒ‡ç¤ºå¾…ã¡ã§ã™ã€‚**

### æ‰¿èªå¾Œã®å®Ÿè£…ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«

| Week | Stage | ä½œæ¥­å†…å®¹ | æˆæœç‰© |
|------|-------|---------|-------|
| Week 1 | Stage 1-2 | PaddleOCR Serviceæ§‹ç¯‰ãƒ»ã‚¯ãƒ­ãƒ¼ã‚ºãƒ‰ãƒ™ãƒ¼ã‚¿ãƒ†ã‚¹ãƒˆ | Dockerã‚³ãƒ³ãƒ†ãƒŠã€ãƒ†ã‚¹ãƒˆãƒ¬ãƒãƒ¼ãƒˆ |
| Week 2 | Stage 3-4 | Shadow A/Bãƒ†ã‚¹ãƒˆãƒ»Canary Deployment | A/Bæ¯”è¼ƒãƒ¬ãƒãƒ¼ãƒˆã€ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ |
| Week 3 | Stage 5 | æ®µéšçš„å®Œå…¨ç§»è¡Œ | æœ¬ç•ªç§»è¡Œå®Œäº†ãƒ¬ãƒãƒ¼ãƒˆ |
| Month 3 | Stage 6 | Geminiå®Œå…¨å»ƒæ­¢ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰ | ã‚³ãƒ¼ãƒ‰ç°¡ç´ åŒ–ã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–° |

---

**ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 2.0
**æœ€çµ‚æ›´æ–°**: 2025å¹´11æœˆ16æ—¥
**ä½œæˆè€…**: Claude Code (Anthropic)
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: ğŸ“‹ **å®Ÿè£…æ‰¿èªå¾…ã¡** â³
**æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®æ˜ç¤ºçš„ãªå®Ÿè£…GOæŒ‡ç¤º
